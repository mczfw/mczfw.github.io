<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh">

<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>我的世界服务器列表 - Minecraft Server list</title>
  <meta name="description" content="我的世界服务器列表，查找自己喜欢的服务器，这里有我的世界服务器IP地址大全。">
  <meta name="keywords" content="我的世界服务器, 我的世界服务器列表">

  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">

  <style>
    /* === 基础样式（同上，略去重复注释）=== */
    * {
      box-sizing: border-box;
    }

    body {
      font-family: PingFang SC, HarmonyOS_Regular, Helvetica Neue, Microsoft YaHei, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #fafafa;
      color: #333;
      line-height: 1.6;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
      width: 90%;
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      text-align: center;
    }

    h1 a {
      color: inherit;
      text-decoration: none;
    }

    h1 a:hover {
      color: #5cb85c;
    }

    .x {
      text-align: center;
      margin-bottom: 20px;
      color: #666;
      font-size: 0.95rem;
    }

    .x a {
      color: #5cb85c;
      font-weight: bold;
    }

    #myForm {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    #myForm input {
      padding: 10px;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      min-width: 250px;
      max-width: 100%;
    }

    #myForm button {
      padding: 10px 20px;
      font-size: 1rem;
      border: none;
      border-radius: 4px;
      background: #5cb85c;
      color: white;
      cursor: pointer;
    }

    #myForm button:hover {
      background: #4cae4c;
    }

    #data {
      margin-top: 30px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    /* === 桌面端表格（>768px）=== */
    @media (min-width: 769px) {
      .table-container {
        display: block;
      }

      .table-container table {
        width: 100%;
        border-collapse: collapse;
        font-size: 1rem;
      }

      .table-container th,
      .table-container td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #eee;
      }

      .table-container th {
        background: #f8f9fa;
        font-weight: bold;
        color: #333;
      }

      .table-container tr:hover {
        background: #f8f9fa;
      }

      .table-container td:first-child img {
        width: 40px;
        height: 40px;
        border-radius: 4px;
        object-fit: cover;
      }

      .server-address {
        color: #495057;
        cursor: pointer;
        padding: 2px 6px;
        border-radius: 3px;
        font-family: monospace;
        font-size: 0.9rem;
        background: rgba(92, 184, 92, 0.1);
        border: 1px solid transparent;
        display: inline-block;
      }

      .server-address:hover {
        background: rgba(92, 184, 92, 0.2);
        border-color: #5cb85c;
      }
    }

    /* === 手机端卡片（≤768px）=== */
    @media (max-width: 768px) {
      .table-container {
        display: none;
      }

      .card-container {
        display: block;
      }

      .server-card {
        background: #fff;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        margin-bottom: 16px;
        padding: 16px;
      }

      .server-card-header {
        display: flex;
        align-items: center;
        margin-bottom: 12px;
      }

      .server-card-icon {
        width: 40px;
        height: 40px;
        border-radius: 4px;
        object-fit: cover;
        margin-right: 10px;
      }

      .server-card-icon-placeholder {
        width: 40px;
        height: 40px;
        background: #f0f0f0;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #999;
        font-size: 18px;
        margin-right: 10px;
      }

      .server-card-title {
        font-size: 1rem;
        font-weight: 600;
        color: #333;
      }

      .server-card-content {
        font-size: 0.9rem;
      }

      .server-card-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 6px;
        align-items: center;
      }

      .server-card-row:last-child {
        margin-bottom: 0;
      }

      .server-card-label {
        font-weight: 500;
        color: #666;
        min-width: 80px;
      }

      .server-card-value {
        color: #333;
        text-align: right;
        flex: 1;
      }

      .server-card-address {
        color: #495057;
        cursor: pointer;
        padding: 3px 6px;
        border-radius: 3px;
        font-family: monospace;
        font-size: 0.8rem;
        background: rgba(92, 184, 92, 0.1);
        border: 1px solid transparent;
        display: inline-block;
      }

      .server-card-address:hover {
        background: rgba(92, 184, 92, 0.2);
        border-color: #5cb85c;
      }

      .loading-text,
      .error-text {
        padding: 30px 20px;
        text-align: center;
        font-size: 1rem;
      }

      .error-text {
        color: #dc3545;
      }
    }

    @media (max-width: 768px) {
      .table-container {
        display: none !important;
      }

      .card-container {
        display: block !important;
      }
    }

    @media (min-width: 769px) {
      .table-container {
        display: block !important;
      }

      .card-container {
        display: none !important;
      }
    }

    /* === 复制提示 === */
    #copyTooltip {
      position: fixed;
      background: #28a745;
      color: white;
      padding: 6px 10px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 10000;
      pointer-events: none;
      opacity: 0;
      transform: translate(-50%, -50%);
      transition: opacity 0.3s;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    }

    #copyTooltip.show {
      opacity: 1;
    }

    #copyTooltip.error {
      background: #dc3545;
    }

    /* === 返回顶部（可选）=== */
    .back-to-top {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 50px;
      height: 50px;
      background: #5cb85c;
      color: white;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      font-size: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(92, 184, 92, 0.3);
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
      z-index: 1000;
    }

    .back-to-top.show {
      opacity: 1;
      visibility: visible;
    }

    .back-to-top:hover {
      background: #4cae4c;
    }

    /* === 页脚 === */
    .footer-download {
      margin-top: 40px;
      padding: 20px;
      text-align: center;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .footer-download a {
      color: #5cb85c;
      text-decoration: none;
      padding: 10px 20px;
      border: 1px solid #5cb85c;
      border-radius: 4px;
      display: inline-block;
      transition: all 0.3s;
    }

    .footer-download a:hover {
      background: #5cb85c;
      color: #fff;
    }
  </style>
</head>

<body>
  <div class="container">
    <header>
      <h1><a href="/">我的世界服务器列表</a></h1>
    </header>

    <main>
      <section>
        <p class="x">
          我的世界服务器列表，查找自己喜欢的服务器，这里有我的世界服务器IP地址大全，
          <a href="https://list.mczfw.cn">我的世界服务器列表驱动引擎</a>。
        </p>

        <form id="myForm">
          <input type="text" name="ip" placeholder="请输入服务器IP地址" required>
          <button type="submit">查询</button>
        </form>

        <div id="data">
          <!-- 桌面端表格 -->
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>图标</th>
                  <th>服务器地址</th>
                  <th>MOTD</th>
                </tr>
              </thead>
              <tbody id="tableBody">
                <tr><td colspan="3">🔄 正在加载服务器列表...</td></tr>
              </tbody>
            </table>
          </div>

          <!-- 手机端卡片 -->
          <div class="card-container" id="cardContainer">
            <div style="padding: 40px; text-align: center; color: #666;">🔄 正在加载...</div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- 复制提示 -->
  <div id="copyTooltip" class="copy-tooltip">✅ 已复制</div>

  <!-- 返回顶部 -->
  <button id="backToTop" class="back-to-top" title="返回顶部">↑</button>

  <!-- 页脚 -->
  <div class="footer-download">
    <a href="https://list.mczfw.cn/download?download=静态我的世界服务器查询网站源码">点击下载我的世界查询网站源码</a>
  </div>

  <script>
    // ======================
    // 1. 复制功能（全局函数，修复版）
    // ======================

    function copyToClipboard(text, element) {
      if (element) {
        element.style.transform = 'scale(0.95)';
        setTimeout(() => { element.style.transform = ''; }, 150);
      }

      if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(text).then(() => {
          showCopyTooltip('✅ 已复制', false);
        }).catch(() => {
          fallbackCopyTextToClipboard(text);
        });
      } else {
        fallbackCopyTextToClipboard(text);
      }
    }

    function fallbackCopyTextToClipboard(text) {
      const textarea = document.createElement('textarea');
      textarea.value = text;
      textarea.style.cssText = 'position:fixed;left:-9999px;top:-9999px;opacity:0;';
      document.body.appendChild(textarea);
      textarea.select();
      try {
        if (document.execCommand('copy')) {
          showCopyTooltip('✅ 已复制', false);
        } else {
          showCopyTooltip('❌ 复制失败', true);
        }
      } catch (err) {
        showCopyTooltip('❌ 复制失败', true);
      }
      document.body.removeChild(textarea);
    }

    function showCopyTooltip(text, isError) {
      const tooltip = document.getElementById('copyTooltip');
      tooltip.textContent = text;
      tooltip.className = isError ? 'copy-tooltip error show' : 'copy-tooltip show';
      tooltip.style.left = '50%';
      tooltip.style.top = '50%';
      tooltip.style.transform = 'translate(-50%, -50%)';
      setTimeout(() => { tooltip.className = 'copy-tooltip'; }, 2000);
    }

    // ======================
    // 2. 渲染函数
    // ======================

    const tableBody = document.getElementById('tableBody');
    const cardContainer = document.getElementById('cardContainer');

    function showLoading() {
      if (window.innerWidth <= 768) {
        cardContainer.innerHTML = '<div style="padding: 40px; text-align: center; color: #666;">🔄 正在加载...</div>';
      } else {
        tableBody.innerHTML = '<tr><td colspan="3">🔄 正在加载服务器列表...</td></tr>';
      }
    }

    function showError(message = '❌ 加载失败') {
      if (window.innerWidth <= 768) {
        cardContainer.innerHTML = `<div style="padding: 40px; text-align: center; color: #dc3545;">${message}</div>`;
      } else {
        tableBody.innerHTML = `<tr><td colspan="3">${message}</td></tr>`;
      }
    }

    function renderTable(data) {
      let html = '';
      data.forEach(row => {
        const icon = row.logo ? `<img src="${row.logo}" alt="icon">` : '';
        const address = row.ip || 'N/A';
        const motd = row.motd || 'N/A';

        const processedAddress = address.replace(
          /((?:\b(?:\d{1,3}\.){3}\d{1,3}\b|[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})(?::\d+)?)/g,
          '<span class="server-address" onclick="copyToClipboard(\'$1\', this)" title="点击复制">$1</span>'
        );

        html += `
          <tr>
            <td>${icon}</td>
            <td>${processedAddress}</td>
            <td>${motd}</td>
          </tr>
        `;
      });
      tableBody.innerHTML = html;
    }

    function renderCards(data) {
      let html = '';
      data.forEach((row, i) => {
        const icon = row.logo ? `<img src="${row.logo}" alt="icon" class="server-card-icon">` : '<div class="server-card-icon-placeholder">🎮</div>';
        const address = row.ip || `服务器 ${i + 1}`;
        const motd = row.motd || '暂无描述';

        const processedAddress = address.replace(
          /((?:\b(?:\d{1,3}\.){3}\d{1,3}\b|[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})(?::\d+)?)/g,
          '<span class="server-card-address" onclick="copyToClipboard(\'$1\', this)" title="点击复制">$1</span>'
        );

        html += `
          <div class="server-card">
            <div class="server-card-header">
              ${icon}
              <div class="server-card-title">${address}</div>
            </div>
            <div class="server-card-content">
              <div class="server-card-row">
                <span class="server-card-label">服务器地址:</span>
                <span class="server-card-value">${processedAddress}</span>
              </div>
              <div class="server-card-row">
                <span class="server-card-label">服务器MOTD:</span>
                <span class="server-card-value">${motd}</span>
              </div>
            </div>
          </div>
        `;
      });
      cardContainer.innerHTML = html;
    }

    // ======================
    // 3. 加载默认服务器列表（真实 API）
    // ======================

    async function loadDefaultServers() {
      showLoading();
      try {
        const res = await fetch('https://list.mczfw.cn/api');
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();
        if (!Array.isArray(data)) throw new Error('返回数据不是数组');

        if (window.innerWidth <= 768) {
          renderCards(data);
        } else {
          renderTable(data);
        }
      } catch (err) {
        console.error('加载默认列表失败:', err);
        showError('❌ 获取服务器列表失败，请检查网络');
      }
    }

    // ======================
    // 4. 查询单个 IP（真实 API）
    // ======================

    async function queryServerIP(ip) {
      if (!ip?.trim()) {
        showError('⚠️ 请输入有效的服务器IP');
        return;
      }

      showLoading();
      try {
        const encoded = encodeURIComponent(ip.trim());
        const res = await fetch(`https://list.mczfw.cn/api/${encoded}`);
        if (!res.ok) throw new Error(`查询失败: ${res.status}`);

        const data = await res.json();
        if (!data) throw new Error('返回数据为空');

        // 假设返回的数据结构包含 p(在线人数), mp(最大人数), motd, logo
        // 如果没有，我们至少显示在线人数和状态
        const onlineText = `${data.p || 'N/A'} / ${data.mp || 'N/A'}`;
        const statusText = '在线';
        const motd = data.motd || 'N/A';
        const logo = data.logo || '';

        const mockRowForSingle = [{ logo, ip: `${ip}:25565`, motd: motd || '服务器运行中' }];

        if (window.innerWidth <= 768) {
          const processed = mockRowForSingle.map(r => ({
            ...r,
            logo,
            ip: r.ip,
            motd
          }));
          renderCards(processed);
        } else {
          renderTable(mockRowForSingle);
        }
      } catch (err) {
        console.error('查询IP失败:', err);
        showError('❌ 查询该IP服务器失败');
      }
    }

    // ======================
    // 5. 页面初始化
    // ======================

    document.addEventListener('DOMContentLoaded', () => {
      loadDefaultServers();

      // 表单提交：查询 IP
      document.getElementById('myForm').addEventListener('submit', (e) => {
        e.preventDefault();
        const ipInput = document.querySelector('input[name="ip"]');
        const ip = ipInput.value;
        queryServerIP(ip);
      });

      // 返回顶部
      const backToTopBtn = document.getElementById('backToTop');
      window.addEventListener('scroll', () => {
        if (window.pageYOffset > 300) {
          backToTopBtn.classList.add('show');
        } else {
          backToTopBtn.classList.remove('show');
        }
      });

      backToTopBtn.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });
    });

    // 百度统计
    var _hmt = _hmt || [];
    (function () {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?56cd7ad35698ff4d95797ec00c9cb5b5";
      var s = document.getElementsByTagName("script")[0];
      if (s) s.parentNode.insertBefore(hm, s);
    })();
  </script>
</body>

</html>
